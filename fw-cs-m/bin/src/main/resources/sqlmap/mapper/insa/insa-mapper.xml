<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="Insa">

<!-- 권한변경을 위한 사원조회 -->
<select id="getEmpSrchList2" resultType="Hmap" parameterType="InSaVO" > 
/* insa-mapper.xml getEmpSrchList2 사원정보 조회 */
 SELECT A.EMP_CD     		/* 사원코드 VARCHAR2(10)    */
	  , A.EMP_NM     		/* 사원명 VARCHAR2(20) */
	  , '['||A.EMP_CD||':'||A.EMP_NM||'] '|| B.SNMPATH AS EMPINFO	/* 사원정보(계약등록 시 퀵서치에서 사용) */
	  , A.USER_ID    		/* 사용자아이디 VARCHAR2(20) */
	  , A.SCD        		/* 조직코드 VARCHAR2(20) */
	  , B.SNM				/* 조직명 */
	  , B.SNMPATH			/* 조직명경로 */
	  , A.ENT_YMD    		/* 입사일 VARCHAR2(10) */
	  , A.JIKGUB    		/* 직급 VARCHAR2(3) */
	  , A.JIKCHK    		/* 직책 VARCHAR2(3) */
	  , A.HPNO				/* 휴대폰번호 */
	  , A.MB_ID 			/* 회사코드  */
	  , A.ROLE_ID
   FROM (SELECT * FROM TBIN_EMPMST WHERE MB_ID = #{MB_ID} <![CDATA[AND NVL(DATA_DCD,'I') <> 'D']]> ) A /* [인사마스터] */  
   		   LEFT OUTER JOIN 
	    (SELECT SUBSTR(SYS_CONNECT_BY_PATH(SCD,'/'), 2) AS SCDPATH
              , SUBSTR(SYS_CONNECT_BY_PATH(SNM,'/'), 2) AS SNMPATH
              , SCD
              , SNM
              , MB_ID
           FROM (SELECT * FROM TBIN_SCD WHERE MB_ID = #{MB_ID} ) A
          START WITH PSCD IS NULL
        CONNECT BY PRIOR SCD = PSCD
        ) B /* [조직마스터] */
        ON  A.MB_ID = B.MB_ID
        AND A.SCD   = B.SCD
<where> 
    AND <![CDATA[ A.EMP_CD NOT IN ( 'SADMIN', 'ADMIN', 'INSCOM' ) ]]>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SEARCH_WORD)'><![CDATA[
    AND (  UPPER(A.EMP_NM) LIKE UPPER('%'|| UPPER(#{SEARCH_WORD}) ||'%')
        OR UPPER(A.EMP_CD) LIKE UPPER('%'|| UPPER(#{SEARCH_WORD}) ||'%')
        )
]]>
</if> 
</where>
  ORDER BY A.EMP_NM
</select>

<!-- 조직등록을 위한 사원조회 -->
<select id="selectEmpSchList" resultType="Hmap" parameterType="InsaVO">
/* insa-mapper.xml selectEmpSchList 조직등록을 위한 사원조회 */
/* TBIN_EMPMST[[IN][인사] 인사마스터] SELECT */
SELECT A.MB_ID             /* 회원사ID                                     VARCHAR2(20)   */
     , A.SEQ               /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
     , A.EMP_CD            /* 사원코드                                     VARCHAR2(20)   */
     , A.EMP_NM            /* 사원명                                       VARCHAR2(20)   */
     , A.USER_ID           /* 사원ID                                       VARCHAR2(20)   */
     , A.SCD               /* 조직코드                                     VARCHAR2(20)   */
     , A.PERNO             /* 주민등록번호                                 VARCHAR2(4000) */
     , A.HPNO              /* 핸드폰번호                                   VARCHAR2(20)   */
     , A.JOIN_GBN          /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
     , A.NOW_SCD           /* 현소속                                  VARCHAR2(15)   */
     , A.JIKGUB            /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
     , A.JIKCHK            /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
     , A.ROLE_ID           /* 시스템 사용권한                              VARCHAR2(10)   */
     , A.BOARD_ROLE_ID     /* 게시판 사용권한                              VARCHAR2(10)   */
     , A.EMAIL             /* 이메일                                       VARCHAR2(50)   */
     , A.ZIPCD             /* 우편번호                                     VARCHAR2(7)    */
     , A.ADDR1             /* 자택주소                                     VARCHAR2(200)  */
     , A.ADDR2             /* 자택주소상세                                 VARCHAR2(200)  */
     , A.EMPSTA            /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
     , A.PAY_GBN           /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
     , A.RE_EMP_CD         /* 소개자 사원코드                              VARCHAR2(20)   */
     , A.RE_EMP_NM         /* 소개자 사원명                                VARCHAR2(20)   */
     , A.MG_EMP_CD         /* 관리자 사원코드                              VARCHAR2(20)   */
     , A.MG_EMP_NM         /* 관리자 사원명                                VARCHAR2(20)   */
     , A.RCRT_TYPE         /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
     , A.ENT_YMD           /* 입사일자                                     VARCHAR2(10)   */
     , A.END_YMD           /* 퇴사일자                                     VARCHAR2(10)   */
     , A.BANK              /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
     , A.BK_ID             /* 계좌번호                                     VARCHAR2(66)   */
     , A.OWNER             /* 예금주                                       VARCHAR2(50)   */
     , A.OWNER_RELATION    /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , (SELECT CD_VL_NM FROM TBCM_COMMON_CODE WHERE GRP_CMM_CD = 'OWNER_RELATION' AND MB_ID = #{MB_ID} AND CD_VL = A.OWNER_RELATION) AS OWNER_RELATIONNM  /* 예금주와의 관계명 */
     , A.MEMO              /* 메모                                         VARCHAR2(1000) */
     , A.FILE_NAME         /* 첨부파일명                                   VARCHAR2(200)  */
     , A.IN_EMP_CD         /* 입력자 사번                                  VARCHAR2(20)   */
     , A.IN_DTM            /* 입력 일시                                    DATE(7)        */
     , A.IN_IP             /* 입력자 IP                                    VARCHAR2(40)   */
     , A.UP_EMP_CD         /* 수정자 사번                                  VARCHAR2(20)   */
     , A.UP_DTM            /* 수정일시                                     DATE(7)        */
  FROM (SELECT * FROM TBIN_EMPMST WHERE MB_ID = #{MB_ID} <![CDATA[AND NVL(DATA_DCD,'I') <> 'D']]>) A /* [IN][인사] 인사마스터 */
 WHERE A.EMP_CD NOT IN ('SADMIN', 'INSCOMNVL', 'INSCOM', 'ADMIN', 'WWL_INSCOM', 'ADMIN2')
	<if test="@kr.co.fw.common.util.CommUtil@isNotEmpty(SEARCH_WORD)">
		AND ( A.EMP_NM LIKE '%'||#{SEARCH_WORD}||'%'
		   OR A.EMP_CD LIKE '%'||#{SEARCH_WORD}||'%' )
	</if>
ORDER BY A.EMP_NM
</select>

<!-- 인사 트리뷰 목록조회 -->
<select id="selectInsaTreeView" resultType="Hmap" parameterType="InSaVO" >  
/* insa-mapper.xml selectInsaTreeView 인사트리뷰 조회  */
SELECT *
    FROM ( SELECT LEVEL
                 , CONNECT_BY_ISLEAF AS ISLEAF
                 , EMP_CD
                 , EMP_NM
                 , MG_EMP_CD
                FROM TBIN_EMPMST
             WHERE MB_ID = #{MB_ID }
               AND EMP_CD NOT IN ( 'SADMIN', 'ADMIN', 'INSCOM' )
 	<![CDATA[  AND NVL(DATA_DCD,'I') <> 'D'	]]>
 	<choose>
	 	<when test='@kr.co.fw.common.util.CommUtil@isNotEquals(USER_ROLE_IDS,"ROLE_ADMIN") 
		  and @kr.co.fw.common.util.CommUtil@isNotEquals(USER_ROLE_IDS,"ROLE_SUPER") 
		  and @kr.co.fw.common.util.CommUtil@isNotEquals(USER_ROLE_IDS,"ROLE_STAFF")
		  and @kr.co.fw.common.util.CommUtil@isEmpty(EMP_CD)'>
 			   AND EMP_CD = #{IN_EMP_CD }
              START WITH EMP_CD = #{IN_EMP_CD }
	 	</when>
	 	<when test='@kr.co.fw.common.util.CommUtil@isEmpty(EMP_CD)'>
 			   -- AND MG_EMP_CD IS NULL
              START WITH EMP_CD = 'FW0000'
	 	</when>
	 	<otherwise>
 			   AND MG_EMP_CD = #{EMP_CD }
              START WITH EMP_CD = #{EMP_CD }
	 	</otherwise>
 	</choose>  CONNECT BY PRIOR EMP_CD = MG_EMP_CD )
</select>

<!-- 사원 리스트 가져오기 -->
<select id="selectInsaList" resultType="Hmap" parameterType="InSaVO" >  
/* insa-mapper.xml selectInsaList 사원 리스트 가져오기 */
SELECT A.*
	${queryStr}
  FROM (SELECT A.MB_ID             /* 회원사ID                                     VARCHAR2(20)   */
		     , A.SEQ               /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
		     , A.EMP_CD            /* 사원코드                                     VARCHAR2(20)   */
		     , A.EMP_NM            /* 사원명                                       VARCHAR2(20)   */
		     , A.EMP_NME           /* 사원영문명                                       VARCHAR2(20)   */
     		 , A.PASSPORT_NUM      /* 여권번호                                VARCHAR2(15) */
		     , A.USER_ID           /* 사원ID                                       VARCHAR2(20)   */
		     , A.SCD               /* 조직코드                                     VARCHAR2(20)   */
			 , B.SNM 	           /* 조직이름 */
		     , A.PERNO             /* 주민등록번호                                 VARCHAR2(4000) */
		     , A.HPNO              /* 핸드폰번호                                   VARCHAR2(20)   */
		     , A.JOIN_GBN          /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
		     , A.NOW_SCD           /* 현소속                                  VARCHAR2(15)   */
		     , A.JIKGUB            /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
		     , A.JIKCHK            /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
		     , A.ROLE_ID           /* 시스템 사용권한                              VARCHAR2(10)   */
     		 , C.ROLE_NAME
		     , (SELECT ROLE_NAME FROM TBSY_ROLES_MST WHERE MB_ID = #{MB_ID} AND ROLE_ID = A.ROLE_ID) AS ROLE_NM /* 시스템 사용권한명 */
		     , A.BOARD_ROLE_ID     /* 게시판 사용권한                              VARCHAR2(10)   */
		     , (SELECT AUTH_GRP_NM FROM TBBD_USER_AUTHORITY_GROUP WHERE MB_ID = #{MB_ID} AND AUTH_GRP_CD = A.BOARD_ROLE_ID) AS BOARD_ROLE_NM /* 게시판 사용권한명 */
		     , A.EMAIL             /* 이메일                                       VARCHAR2(50)   */
		     , A.ZIPCD             /* 우편번호                                     VARCHAR2(7)    */
		     , A.ADDR1             /* 자택주소                                     VARCHAR2(200)  */
		     , A.ADDR2             /* 자택주소상세                                 VARCHAR2(200)  */
		     , A.ADDRE1             /* 영문자택주소                                     VARCHAR2(200)  */
		     , A.ADDRE2             /* 영문자택주소상세                                 VARCHAR2(200)  */
		     , A.EMPSTA            /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
		     , A.PAY_GBN           /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
		     , A.RE_EMP_CD         /* 소개자 사원코드                              VARCHAR2(20)   */
		     , A.RE_EMP_NM         /* 소개자 사원명                                VARCHAR2(20)   */
		     , A.MG_EMP_CD         /* 관리자 사원코드                              VARCHAR2(20)   */
		     , A.MG_EMP_NM         /* 관리자 사원명                                VARCHAR2(20)   */
    		 , (SELECT SNM FROM TBIN_SCD WHERE SCD = (SELECT SCD FROM TBIN_EMPMST WHERE EMP_CD = A.RE_EMP_CD AND MB_ID = #{MB_ID}) AND MB_ID = #{MB_ID}) AS RE_EMP_SNM /* 소개자 조직명 */
		     , A.RCRT_TYPE         /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
		     , (SELECT CD_VL_NM FROM TBCM_COMMON_CODE WHERE GRP_CMM_CD = 'RCRT_TYPE' AND MB_ID = #{MB_ID} AND CD_VL = A.RCRT_TYPE) AS RCRT_TYPENM /* 유치방식명 */
		     , A.ENT_YMD           /* 입사일자                                     VARCHAR2(10)   */
		     , A.END_YMD           /* 퇴사일자                                     VARCHAR2(10)   */
		     , A.BANK              /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
		     , A.BK_ID             /* 계좌번호                                     VARCHAR2(66)   */
		     , A.OWNER             /* 예금주                                       VARCHAR2(50)   */
		     , A.OWNER_RELATION    /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
		     , A.H_BANK AS HBANK              /* 홍콩 은행코드(GRP_CMM_CD = H_BANK)                  VARCHAR2(20)   */
		     , A.H_BK_ID AS HBK_ID             /* 홍콩 계좌번호                                     VARCHAR2(66)   */
		     , A.H_OWNER AS HOWNER             /* 홍콩 예금주                                       VARCHAR2(50)   */
		     , (SELECT CD_VL_NM FROM TBCM_COMMON_CODE WHERE GRP_CMM_CD = 'OWNER_RELATION' AND MB_ID = #{MB_ID} AND CD_VL = A.OWNER_RELATION) AS OWNER_RELATIONNM  /* 예금주와의 관계명 */
		     , A.MEMO              /* 메모                                         VARCHAR2(1000) */
		     , A.FILE_NAME         /* 첨부파일명                                   VARCHAR2(200)  */
		     , A.IN_EMP_CD         /* 입력자 사번                                  VARCHAR2(20)   */
		     , A.IN_DTM            /* 입력 일시                                    DATE(7)        */
		     , A.IN_IP             /* 입력자 IP                                    VARCHAR2(40)   */
		     , A.UP_EMP_CD         /* 수정자 사번                                  VARCHAR2(20)   */
		     , A.UP_DTM            /* 수정일시                                     DATE(7)        */
	         , B.SCDNMPATH       /* 소속경로 */
	         , B.SCDPATH         /* 소속코드경로 */
	         , B.SNMPATH         /* 소속경로2 */
	         , A.DATA_DCD
          FROM TBIN_EMPMST A /* 인사_마스터(상세정보)      */
         	 LEFT OUTER JOIN 
     		   (SELECT SUBSTR(SYS_CONNECT_BY_PATH(SCD,'>'), 2) AS SCDPATH
	                 , SUBSTR(SYS_CONNECT_BY_PATH(SNM,'>'), 2) AS SCDNMPATH
					 , CASE WHEN SCD = '0000' THEN SNM
				            ELSE SUBSTR(SYS_CONNECT_BY_PATH(SNM,'/'), (SELECT LENGTH(SNM) FROM TBIN_SCD WHERE MB_ID = #{MB_ID} AND SCD = '0000')+3)
				       END AS SNMPATH    /* 소속경로2 */
	                 , SCD
	                 , SNM
	                 , MB_ID
	              FROM (SELECT * FROM TBIN_SCD WHERE MB_ID = #{MB_ID}) A
	             START WITH PSCD IS NULL
	           CONNECT BY PRIOR SCD = PSCD
	           ) B
	           ON  A.MB_ID = B.MB_ID
	           AND A.SCD   = B.SCD
			  LEFT OUTER JOIN TBSY_ROLES_MST C
				ON A.MB_ID = C.MB_ID
			   AND A.ROLE_ID   = C.ROLE_ID
	   ) A
 WHERE A.MB_ID = #{MB_ID}
 	 AND A.EMP_CD NOT IN ( 'SADMIN', 'ADMIN', 'INSCOM' )
<![CDATA[AND NVL(A.DATA_DCD,'I') <> 'D']]>
<if test='@kr.co.fw.common.util.CommUtil@isNotEquals(USER_ROLE_IDS,"ROLE_ADMIN") 
	  and @kr.co.fw.common.util.CommUtil@isNotEquals(USER_ROLE_IDS,"ROLE_SUPER") 
	  and @kr.co.fw.common.util.CommUtil@isNotEquals(USER_ROLE_IDS,"ROLE_STAFF")
	  and @kr.co.fw.common.util.CommUtil@isEmpty(SRCH_EMP)'>
	START WITH A.EMP_CD = #{IN_EMP_CD}
 CONNECT BY PRIOR A.EMP_CD = A.MG_EMP_CD
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_EMP)'>
	START WITH A.EMP_CD = #{SRCH_EMP}
 CONNECT BY PRIOR A.EMP_CD = A.MG_EMP_CD
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(EMP_CD)'>
   AND A.EMP_CD = #{EMP_CD}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_SCD)'>    
	AND A.SCDPATH LIKE '%' || #{SRCH_SCD} || '%'
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_JIKCHK)'>    
	AND A.JIKCHK = #{SRCH_JIKCHK}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_JIKGUB)'>    
	AND A.JIKGUB = #{SRCH_JIKGUB}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_BOARD_AUTH)'>    
	AND A.BOARD_ROLE_ID = #{SRCH_BOARD_AUTH}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_ROLE_ID)'>    
	AND A.ROLE_ID = #{SRCH_ROLE_ID}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_EMPSTA)'>    
	AND A.EMPSTA = #{SRCH_EMPSTA}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isEquals(SRCH_TERM, "01")'>    <!-- 등록일 -->
	<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_END_VALUE)'>
	<![CDATA[ AND A.ENT_YMD <= #{SRCH_TERM_END_VALUE} ]]>
	</if>  
	<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_START_VALUE)'>
	<![CDATA[ AND A.ENT_YMD >= #{SRCH_TERM_START_VALUE} ]]>
	</if>		
</if>
<if test='@kr.co.fw.common.util.CommUtil@isEquals(SRCH_TERM, "02")'>    <!-- 말소일 -->
	<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_END_VALUE)'>
	<![CDATA[ AND A.END_YMD <= #{SRCH_TERM_END_VALUE} ]]>
	</if>  
	<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_START_VALUE)'>
	<![CDATA[ AND A.START_YMD >= #{SRCH_TERM_START_VALUE} ]]>
	</if>		
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_EMP_VALUE)'>
	AND (
		   A.EMP_NM LIKE '%'||#{SRCH_EMP_VALUE}||'%'
		OR A.EMP_CD LIKE '%'||UPPER(#{SRCH_EMP_VALUE})||'%'
		OR A.USER_ID LIKE '%'||#{SRCH_EMP_VALUE}||'%'
		OR A.PERNO = #{SRCH_EMP_VALUE} /* 개인정보보호를 위해 정확히 기입했을때만 조회 */
		OR A.HPNO LIKE '%'||#{SRCH_EMP_VALUE}||'%'
	)
</if>
 ORDER BY A.IN_DTM DESC
</select>

<!-- 하나의 사원정보 조회 -->
<select id="selectEmpInfo" resultType="Hmap" parameterType="InSaVO">
/* insa-mapper.xml selectEmpInfo 사원정보 조회 */
/* TBIN_EMPMST[[IN][인사] 인사마스터] SELECT */
SELECT A.MB_ID             /* 회원사ID                                     VARCHAR2(20)   */
     , A.SEQ               /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
     , A.EMP_CD            /* 사원코드                                     VARCHAR2(20)   */
     , A.EMP_NM            /* 사원명                                       VARCHAR2(20)   */
     , A.EMP_NME           /* 영문이름                                    VARCHAR2(30)   */
     , A.USER_ID           /* 사원ID                                       VARCHAR2(20)   */
     , A.SCD               /* 조직코드                                     VARCHAR2(20)   */
     , B.SNM               /* 조직명 */
     , B.SCDNMPATH         /* 소속경로 */
     , B.SCDPATH           /* 소속코드경로 */
     , B.SNMPATH           /* 소속경로2 */
     , A.PERNO             /* 주민등록번호                                 VARCHAR2(4000) */
     , A.PASSPORT_NUM      /* 여권번호                                VARCHAR2(15) */
     , A.HPNO              /* 핸드폰번호                                   VARCHAR2(20)   */
     , A.JOIN_GBN          /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
     , A.NOW_SCD           /* 현소속                                  VARCHAR2(15)   */
     , A.JIKGUB            /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
     , A.JIKCHK            /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
     , A.ROLE_ID           /* 시스템 사용권한                              VARCHAR2(10)   */
     , C.ROLE_NAME
     , A.BOARD_ROLE_ID     /* 게시판 사용권한                              VARCHAR2(10)   */
     , A.EMAIL             /* 이메일                                       VARCHAR2(50)   */
     , A.ZIPCD             /* 우편번호                                     VARCHAR2(7)    */
     , A.ADDR1             /* 자택주소                                     VARCHAR2(200)  */
     , A.ADDR2             /* 자택주소상세                                 VARCHAR2(200)  */
     , A.ADDRE1             /* 영문주소                                     VARCHAR2(200)  */
     , A.ADDRE2             /* 영문주소상세                                 VARCHAR2(200)  */
     , A.EMPSTA            /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
     , A.PAY_GBN           /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
     , A.RE_EMP_CD         /* 소개자 사원코드                              VARCHAR2(20)   */
     , A.RE_EMP_NM         /* 소개자 사원명                                VARCHAR2(20)   */
     , A.MG_EMP_CD         /* 관리자 사원코드                              VARCHAR2(20)   */
     , A.MG_EMP_NM         /* 관리자 사원명                                VARCHAR2(20)   */
     , (SELECT SNM FROM TBIN_SCD WHERE SCD = (SELECT SCD FROM TBIN_EMPMST WHERE EMP_CD = A.RE_EMP_CD AND MB_ID = #{MB_ID}) AND MB_ID = #{MB_ID}) AS RE_EMP_SNM /* 소개자 조직명 */
     , (SELECT JIKGUB FROM TBIN_EMPMST WHERE EMP_CD = A.RE_EMP_CD AND MB_ID = #{MB_ID}) AS RE_JIKGUB /* 소개자 직급 */
     , A.RCRT_TYPE         /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
     , A.ENT_YMD           /* 입사일자                                     VARCHAR2(10)   */
     , A.END_YMD           /* 퇴사일자                                     VARCHAR2(10)   */
     , A.BANK              /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
     , A.BK_ID             /* 계좌번호                                     VARCHAR2(66)   */
     , A.OWNER             /* 예금주                                       VARCHAR2(50)   */
     , A.OWNER_RELATION    /* 예금주와의 관계 코드(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , A.H_BANK AS HBANK              /* 홍콩 은행코드(GRP_CMM_CD = H_BANK)                  VARCHAR2(20)   */
     , A.H_BK_ID AS HBK_ID             /* 홍콩 계좌번호                                     VARCHAR2(66)   */
     , A.H_OWNER AS HOWNER             /* 홍콩 예금주                                       VARCHAR2(50)   */
     , (SELECT CD_VL_NM FROM TBCM_COMMON_CODE WHERE GRP_CMM_CD='OWNER_RELATION' AND CD_VL=A.OWNER_RELATION) AS OWNER_RELATION_NM/* 예금주와의 관계 값(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , A.MEMO              /* 메모                                         VARCHAR2(1000) */
     , A.FILE_NAME         /* 첨부파일명                                   VARCHAR2(200)  */
     , A.IN_EMP_CD         /* 입력자 사번                                  VARCHAR2(20)   */
     , TO_CHAR(A.IN_DTM, 'YYYY-MM-DD') AS IN_DTM            /* 입력 일시                                    DATE(7)        */
     , A.IN_IP             /* 입력자 IP                                    VARCHAR2(40)   */
     , A.UP_EMP_CD         /* 수정자 사번                                  VARCHAR2(20)   */
     , TO_CHAR(A.UP_DTM, 'YYYY-MM-DD') AS UP_DTM            /* 수정일시                                     DATE(7)        */
     , C.CREDIT
     , C.UPREM_AMT
     , C.HPREM_AMT
     , C.CNT
  FROM TBIN_EMPMST A
  LEFT OUTER JOIN (SELECT MO_CD, SUM(CREDIT) CREDIT, SUM(UPREM_AMT) UPREM_AMT, SUM(HPREM_AMT) HPREM_AMT, COUNT(MO_CD) CNT FROM TBCN_CONTRACT WHERE CONT_STATUS = '정상' AND MO_CD = #{EMP_CD} GROUP BY MO_CD) C
    ON A.EMP_CD = C.MO_CD
  LEFT OUTER JOIN 
  (SELECT SUBSTR(SYS_CONNECT_BY_PATH(SCD,'>'), 2) AS SCDPATH
		, SUBSTR(SYS_CONNECT_BY_PATH(SNM,'>'), 2) AS SCDNMPATH
		, CASE WHEN SCD = '0000' THEN SNM
			   ELSE SUBSTR(SYS_CONNECT_BY_PATH(SNM,'/'), (SELECT LENGTH(SNM) FROM TBIN_SCD WHERE MB_ID = #{MB_ID} AND SCD = '0000')+3)
		  END AS SNMPATH    /* 소속경로2 */
		, SCD
		, SNM
		, MB_ID
	 FROM (SELECT * FROM TBIN_SCD WHERE MB_ID = #{MB_ID}) A
	START WITH PSCD IS NULL
	CONNECT BY PRIOR SCD = PSCD
	) B
	ON A.MB_ID = B.MB_ID
   AND A.SCD   = B.SCD
  LEFT OUTER JOIN TBSY_ROLES_MST C
	ON A.MB_ID = C.MB_ID
   AND A.ROLE_ID   = C.ROLE_ID
 WHERE A.MB_ID = #{MB_ID}
   AND A.EMP_CD = #{EMP_CD}
</select>

<!-- 사원코드 셋팅 [회사코드+0000] -->
<select id="selectEmpCdInfo" resultType="Hmap" parameterType="InSaVO">
/* insa-mapper.xml selectEmpCdInfo 인사 등록 */
SELECT 'FW0'||TRIM(TO_CHAR(TO_NUMBER(NVL(SUBSTR(MAX(EMP_CD), 4), 0)) + 1, '000')) AS EMP_CD
  FROM TBIN_EMPMST
 WHERE MB_ID = #{MB_ID}
   AND EMP_CD NOT IN ('SADMIN','ADMIN', 'INSCOM')
   AND EMP_CD NOT LIKE '%FW1%'
</select>

<!-- 인사 등록 -->
<insert id="insertEmpInfo" parameterType="InSaVO">
<selectKey resultType="String" keyProperty="SEQ" order="BEFORE">
	SELECT TBIN_EMPMST_FSB_SEQ.NEXTVAL AS SEQ FROM DUAL
</selectKey>
/* insa-mapper.xml insertEmpInfo 인사 등록 */
INSERT
  INTO TBIN_EMPMST /* [IN][인사] 인사마스터 */
     ( MB_ID             /* 회원사ID                                     VARCHAR2(20)   */
     , SEQ               /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
     , EMP_CD            /* 사원코드                                     VARCHAR2(20)   */
     , EMP_NM            /* 사원명                                       VARCHAR2(20)   */
     , USER_ID           /* 사원ID                                       VARCHAR2(20)   */
     , SCD               /* 조직코드                                     VARCHAR2(20)   */
     , PERNO             /* 주민등록번호                                 VARCHAR2(4000) */
     , HPNO              /* 핸드폰번호                                   VARCHAR2(20)   */
     , JOIN_GBN          /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
     , NOW_SCD           /* 현소속                                  VARCHAR2(15)   */
     , JIKGUB            /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
     , JIKCHK            /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
     , ROLE_ID           /* 시스템 사용권한                              VARCHAR2(10)   */
     , BOARD_ROLE_ID     /* 게시판 사용권한                              VARCHAR2(10)   */
     , EMAIL             /* 이메일                                       VARCHAR2(50)   */
     , ZIPCD             /* 우편번호                                     VARCHAR2(7)    */
     , ADDR1             /* 자택주소                                     VARCHAR2(200)  */
     , ADDR2             /* 자택주소상세                                 VARCHAR2(200)  */
     , EMPSTA            /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
     , PAY_GBN           /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
     , RE_EMP_CD         /* 소개자 사원코드                              VARCHAR2(20)   */
     , RE_EMP_NM         /* 소개자 사원명                                VARCHAR2(20)   */
     , MG_EMP_CD         /* 관리자 사원코드                              VARCHAR2(20)   */
     , MG_EMP_NM         /* 관리자 사원명                                VARCHAR2(20)   */
     , RCRT_TYPE         /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
     , ENT_YMD           /* 입사일자                                     VARCHAR2(10)   */
     , END_YMD           /* 퇴사일자                                     VARCHAR2(10)   */
     , BANK              /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
     , BK_ID             /* 계좌번호                                     VARCHAR2(66)   */
     , OWNER             /* 예금주                                       VARCHAR2(50)   */
     , OWNER_RELATION    /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , H_BANK              /* 홍콩 은행코드(GRP_CMM_CD = H_BANK)                  VARCHAR2(20)   */
     , H_BK_ID             /* 홍콩 계좌번호                                     VARCHAR2(66)   */
     , H_OWNER             /* 홍콩 예금주                                       VARCHAR2(50)   */
     , MEMO              /* 메모                                         VARCHAR2(1000) */
     , FILE_NAME         /* 첨부파일명                                   VARCHAR2(200)  */
     , IN_EMP_CD         /* 입력자 사번                                  VARCHAR2(20)   */
     , IN_DTM            /* 입력 일시                                    DATE(7)        */
     , IN_IP             /* 입력자 IP                                    VARCHAR2(40)   */
     , PASSPORT_NUM 	/*여권번호				VARCHAR2(15)*/
	, ADDRE1 			/*영문주소				VARCHAR2(250)*/
	, ADDRE2 			/*영문상세주소			VARCHAR2(250)*/
	, EMP_NME 			/*영문이름				VARCHAR2(30)*/
     )
VALUES
     ( #{MB_ID         }   /* 회원사ID                                     VARCHAR2(20)   */
     , TBIN_EMPMST_FSB_SEQ.CURRVAL   /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
     , #{EMP_CD        }   /* 사원코드                                     VARCHAR2(20)   */
     , #{EMP_NM        }   /* 사원명                                       VARCHAR2(20)   */
     , #{EMP_CD        }   /* 사원ID                                       VARCHAR2(20)   */
     , #{SCD           }   /* 조직코드                                     VARCHAR2(20)   */
     , #{PERNO         }   /* 주민등록번호                                 VARCHAR2(4000) */
     , #{HPNO          }   /* 핸드폰번호                                   VARCHAR2(20)   */
     , #{JOIN_GBN      }   /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
     , #{NOW_SCD       }   /* 현소속                                  VARCHAR2(15)   */
     , #{JIKGUB        }   /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
     , #{JIKCHK        }   /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
     , #{ROLE_ID       }   /* 시스템 사용권한                              VARCHAR2(10)   */
     , #{BOARD_ROLE_ID }   /* 게시판 사용권한                              VARCHAR2(10)   */
     , #{EMAIL         }   /* 이메일                                       VARCHAR2(50)   */
     , #{ZIPCD         }   /* 우편번호                                     VARCHAR2(7)    */
     , #{ADDR1         }   /* 자택주소                                     VARCHAR2(200)  */
     , #{ADDR2         }   /* 자택주소상세                                 VARCHAR2(200)  */
     , #{EMPSTA        }   /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
     , #{PAY_GBN       }   /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
     , #{RE_EMP_CD     }   /* 소개자 사원코드                              VARCHAR2(20)   */
     , #{RE_EMP_NM     }   /* 소개자 사원명                                VARCHAR2(20)   */
     , #{MG_EMP_CD     }   /* 관리자 사원코드                              VARCHAR2(20)   */
     , #{MG_EMP_NM     }   /* 관리자 사원명                                VARCHAR2(20)   */
     , #{RCRT_TYPE     }   /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
     , #{ENT_YMD       }   /* 입사일자                                     VARCHAR2(10)   */
     , #{END_YMD       }   /* 퇴사일자                                     VARCHAR2(10)   */
     , #{BANK          }   /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
     , #{BK_ID         }   /* 계좌번호                                     VARCHAR2(66)   */
     , #{OWNER         }   /* 예금주                                       VARCHAR2(50)   */
     , #{OWNER_RELATION}   /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , #{HBANK 	   }   /* 홍콩 은행코드(GRP_CMM_CD = H_BANK)                  VARCHAR2(20)   */
     , #{HBK_ID  	   }   /* 홍콩 계좌번호                                     VARCHAR2(66)   */
     , #{HOWNER       }   /* 홍콩 예금주                                       VARCHAR2(50)   */
     , #{MEMO          }   /* 메모                                         VARCHAR2(1000) */
     , #{FILE_NAME     }   /* 첨부파일명                                   VARCHAR2(200)  */
     , #{IN_EMP_CD     }   /* 입력자 사번                                  VARCHAR2(20)   */
     , SYSDATE             /* 입력 일시                                    DATE(7)        */
     , #{IN_IP         }   /* 입력자 IP                                    VARCHAR2(40)   */
     ,#{PASSPORT_NUM	}
	,#{ADDRE1	}
	,#{ADDRE2	}
	,#{EMP_NME	}
     )
</insert>

<!-- 프로필 파일경로 등록 -->
<update id="updateFilename" parameterType="InSaVO">
UPDATE TBIN_EMPMST /* [IN][인사] 인사마스터 */
   SET FILE_NAME      = #{FILE_NAME     }    /* 첨부파일명                                   VARCHAR2(200)  */
     , UP_EMP_CD      = #{UP_EMP_CD     }    /* 수정자 사번                                  VARCHAR2(20)   */
     , UP_DTM         = SYSDATE              /* 수정일시                                     DATE(7)        */
 WHERE MB_ID = #{MB_ID}
   AND SEQ = #{SEQ}
</update>

<!-- 인사 수정 -->
<update id="updateEmpInfo" parameterType="InSaVO">
/* insa-mapper.xml updateEmpInfo 인사 수정 */
UPDATE TBIN_EMPMST /* [IN][인사] 인사마스터 */
   SET EMP_NM         = #{EMP_NM        }    /* 사원명                                       VARCHAR2(20)   */
     , SCD            = #{SCD           }    /* 조직코드                                     VARCHAR2(20)   */
     , PERNO          = #{PERNO         }    /* 주민등록번호                                 VARCHAR2(4000) */
     , HPNO           = #{HPNO          }    /* 핸드폰번호                                   VARCHAR2(20)   */
     , JOIN_GBN       = #{JOIN_GBN      }    /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
     , NOW_SCD        = #{NOW_SCD       }    /* 현소속                                 VARCHAR2(15)   */
     , JIKGUB         = #{JIKGUB        }    /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
     , JIKCHK         = #{JIKCHK        }    /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
     , ROLE_ID        = #{ROLE_ID       }    /* 시스템 사용권한                              VARCHAR2(10)   */
     , BOARD_ROLE_ID  = #{BOARD_ROLE_ID }    /* 게시판 사용권한                              VARCHAR2(10)   */
     , EMAIL          = #{EMAIL         }    /* 이메일                                       VARCHAR2(50)   */
     , ZIPCD          = #{ZIPCD         }    /* 우편번호                                     VARCHAR2(7)    */
     , ADDR1          = #{ADDR1         }    /* 자택주소                                     VARCHAR2(200)  */
     , ADDR2          = #{ADDR2         }    /* 자택주소상세                                 VARCHAR2(200)  */
     , EMPSTA         = #{EMPSTA        }    /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
     , PAY_GBN        = #{PAY_GBN       }    /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
     , RE_EMP_CD      = #{RE_EMP_CD     }    /* 소개자 사원코드                              VARCHAR2(20)   */
     , RE_EMP_NM      = #{RE_EMP_NM     }    /* 소개자 사원명                                VARCHAR2(20)   */
     , MG_EMP_CD      = #{MG_EMP_CD     }    /* 관리자 사원코드                              VARCHAR2(20)   */
     , MG_EMP_NM      = #{MG_EMP_NM     }    /* 관리자 사원명                                VARCHAR2(20)   */
     , RCRT_TYPE      = #{RCRT_TYPE     }    /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
     , ENT_YMD        = #{ENT_YMD       }    /* 입사일자                                     VARCHAR2(10)   */
     , END_YMD        = #{END_YMD       }    /* 퇴사일자                                     VARCHAR2(10)   */
     , BANK           = #{BANK          }    /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
     , BK_ID          = #{BK_ID         }    /* 계좌번호                                     VARCHAR2(66)   */
     , OWNER          = #{OWNER         }    /* 예금주                                       VARCHAR2(50)   */
     , OWNER_RELATION = #{OWNER_RELATION}    /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , H_BANK    	  = #{HBANK	    }  	 /* 홍콩 은행코드(GRP_CMM_CD = H_BANK)                  VARCHAR2(20)   */
     , H_BK_ID        = #{HBK_ID		}	 /* 홍콩 계좌번호                                     VARCHAR2(66)   */
     , H_OWNER        = #{HOWNER		}    /* 홍콩 예금주                                       VARCHAR2(50)   */
     , MEMO           = #{MEMO          }    /* 메모                                         VARCHAR2(1000) */
     , FILE_NAME      = #{FILE_NAME     }    /* 첨부파일명                                   VARCHAR2(200)  */
     , UP_EMP_CD      = #{UP_EMP_CD     }    /* 수정자 사번                                  VARCHAR2(20)   */
     , UP_DTM         = SYSDATE              /* 수정일시                                     DATE(7)        */
     , PASSPORT_NUM 	= #{PASSPORT_NUM	}/*여권번호				VARCHAR2(15)*/
	 , ADDRE1 			= #{ADDRE1	}/*영문주소				VARCHAR2(250)*/
	 , ADDRE2 			= #{ADDRE2	}/*영문상세주소			VARCHAR2(250)*/
	 , EMP_NME 			= #{EMP_NME	}/*영문이름				VARCHAR2(30)*/
 WHERE MB_ID = #{MB_ID}
   AND EMP_CD = #{EMP_CD}
</update>

<!-- 인사 삭제 -->
<update id="deleteEmpInfo" parameterType="InSaVO">
/* insa-mapper.xml deleteEmpInfo 인사 삭제 */
UPDATE TBIN_EMPMST /* [IN][인사] 인사마스터 */
	SET DATA_DCD='D', 
	UP_EMP_CD=#{IN_EMP_CD}, 
	UP_DTM=SYSDATE
 WHERE MB_ID = #{MB_ID}
   AND EMP_CD = #{EMP_CD}
</update>

<!-- 월별 인사 마감 -->

<!-- 월별 인사 마감 목록 조회 -->
<select id="selectEmpMonthList" parameterType="InSaVO"  resultType="Hmap" >  
/* insa-mapper.xml selectEmpMonthList 월별 인사 마감 목록 조회 */
SELECT A.*
     , UP_EMP.EMP_NM AS UP_EMP_NM
     ${queryStr}
  FROM (SELECT A.COM_YM
  			 , A.MB_ID             /* 회원사ID                                     VARCHAR2(20)   */
		     , A.SEQ               /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
		     , A.EMP_CD            /* 사원코드                                     VARCHAR2(20)   */
		     , A.EMP_NM            /* 사원명                                       VARCHAR2(20)   */
		     , A.USER_ID           /* 사원ID                                       VARCHAR2(20)   */
		     , A.SCD               /* 조직코드                                     VARCHAR2(20)   */
			 , B.SNM 	           /* 조직이름 */
		     , A.PERNO             /* 주민등록번호                                 VARCHAR2(4000) */
		     , A.HPNO              /* 핸드폰번호                                   VARCHAR2(20)   */
		     , A.JOIN_GBN          /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
		     , A.TELNO             /* 집 전화번호                                  VARCHAR2(15)   */
		     , A.JIKGUB            /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
		     , A.JIKCHK            /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
		     , A.ROLE_ID           /* 시스템 사용권한                              VARCHAR2(10)   */
		     , (SELECT ROLE_NAME FROM TBSY_ROLES_MST WHERE MB_ID = #{MB_ID} AND ROLE_ID = A.ROLE_ID) AS ROLE_NM /* 시스템 사용권한명 */
		     , A.EMAIL             /* 이메일                                       VARCHAR2(50)   */
		     , A.ZIPCD             /* 우편번호                                     VARCHAR2(7)    */
		     , A.ADDR1             /* 자택주소                                     VARCHAR2(200)  */
		     , A.ADDR2             /* 자택주소상세                                 VARCHAR2(200)  */
		     , A.EMPSTA            /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
		     , A.PAY_GBN           /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
		     , A.RE_EMP_CD         /* 소개자 사원코드                              VARCHAR2(20)   */
		     , A.RE_EMP_NM         /* 소개자 사원명                                VARCHAR2(20)   */
		     , (SELECT SNM FROM TBIN_SCD WHERE SCD = (SELECT SCD FROM TBIN_EMPMST WHERE EMP_CD = RE_EMP_NM AND MB_ID = #{MB_ID}) AND MB_ID = #{MB_ID}) AS RE_EMP_SNM /* 소개자 조직명 */
		     , A.RCRT_TYPE         /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
		     , (SELECT CD_VL_NM FROM TBCM_COMMON_CODE WHERE GRP_CMM_CD = 'RCRT_TYPE' AND MB_ID = #{MB_ID} AND CD_VL = A.RCRT_TYPE) AS RCRT_TYPENM /* 유치방식명 */
		     , A.ENT_YMD           /* 입사일자                                     VARCHAR2(10)   */
		     , A.END_YMD           /* 퇴사일자                                     VARCHAR2(10)   */
		     , A.BANK              /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
		     , A.BK_ID             /* 계좌번호                                     VARCHAR2(66)   */
		     , A.OWNER             /* 예금주                                       VARCHAR2(50)   */
		     , A.OWNER_RELATION    /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
		     , (SELECT CD_VL_NM FROM TBCM_COMMON_CODE WHERE GRP_CMM_CD = 'OWNER_RELATION' AND MB_ID = #{MB_ID} AND CD_VL = A.OWNER_RELATION) AS OWNER_RELATIONNM  /* 예금주와의 관계명 */
		     , A.MEMO              /* 메모                                         VARCHAR2(1000) */
		     , A.FILE_NAME         /* 첨부파일명                                   VARCHAR2(200)  */
		     , A.IN_EMP_CD         /* 입력자 사번                                  VARCHAR2(20)   */
		     , TO_CHAR(A.IN_DTM, 'YYYY-MM-DD HH24:MI:SS') AS IN_DTM /* 입력 일시   DATE(7)        */
		     , A.IN_IP             /* 입력자 IP                                    VARCHAR2(40)   */
		     , A.UP_EMP_CD         /* 수정자 사번                                  VARCHAR2(20)   */
		     , TO_CHAR(A.UP_DTM, 'YYYY-MM-DD HH24:MI:SS') AS UP_DTM /* 수정일시    DATE(7)        */
		     , CRE_EMP_CD
		     , CRE_DTM
		     , MDF_EMP_CD
		     , MDF_DTM
	         , B.SCDNMPATH       /* 소속경로 */
	         , B.SCDPATH         /* 소속코드경로 */
	         , B.SNMPATH         /* 소속경로2 */
          FROM TBIN_EMP_MONTH A /* 인사_마스터(상세정보)      */
     		   LEFT OUTER JOIN 
     		   (SELECT COM_YM
     		         , SUBSTR(SYS_CONNECT_BY_PATH(SCD,'>'), 2) AS SCDPATH
	                 , SUBSTR(SYS_CONNECT_BY_PATH(SNM,'>'), 2) AS SCDNMPATH
					 , CASE WHEN SCD = '0000' THEN SNM
				            ELSE SUBSTR(SYS_CONNECT_BY_PATH(SNM,'/'), (SELECT LENGTH(SNM) FROM TBIN_SCD WHERE MB_ID = 'GNX' AND SCD = '0000')+3)
				       END AS SNMPATH    /* 소속경로2 */
	                 , SCD
	                 , SNM
	                 , MB_ID
	              FROM (SELECT * FROM TBIN_SCD_MONTH WHERE MB_ID = #{MB_ID} AND COM_YM = #{COM_YM} ) A
	             START WITH PSCD IS NULL
	           CONNECT BY PRIOR SCD = PSCD
	           ) B
	           ON  A.MB_ID  = B.MB_ID
	           AND A.COM_YM = B.COM_YM
	           AND A.SCD    = B.SCD
	   ) A
	   LEFT OUTER JOIN TBIN_EMPMST UP_EMP
	   ON  A.MB_ID     = UP_EMP.MB_ID
	   AND A.UP_EMP_CD = UP_EMP.EMP_CD 
 WHERE A.MB_ID  = #{MB_ID}
   AND A.COM_YM = #{COM_YM}
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(EMP_CD)'>
   AND A.EMP_CD = #{EMP_CD}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_SCD)'>    
	AND A.SCDPATH LIKE '%' || #{SRCH_SCD} || '%'
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_JIKCHK)'>    
	AND A.JIKCHK = #{SRCH_JIKCHK}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_JIKGUB)'>    
	AND A.JIKGUB = #{SRCH_JIKGUB}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_ROLE_ID)'>    
	AND A.ROLE_ID = #{SRCH_ROLE_ID}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_EMPSTA)'>    
	AND A.EMPSTA = #{SRCH_EMPSTA}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_START_VALUE)'>
	<if test='@kr.co.fw.common.util.CommUtil@isEquals(SRCH_TERM, "01")'>    <!-- 입사일 -->
		<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_END_VALUE)'>
		AND A.ENT_YMD BETWEEN #{SRCH_TERM_START_VALUE} AND #{SRCH_TERM_END_VALUE}
		</if>  
		<if test='@kr.co.fw.common.util.CommUtil@isEmpty(SRCH_TERM_END_VALUE)'>
		<![CDATA[ AND A.ENT_YMD >= #{SRCH_TERM_START_VALUE} ]]>
		</if>		
	</if>

</if>
<if test='@kr.co.fw.common.util.CommUtil@isEmpty(SRCH_TERM_START_VALUE)'>
	<if test='@kr.co.fw.common.util.CommUtil@isEquals(SRCH_TERM, "01")'>    <!-- 입사일 -->
		<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_END_VALUE)'>
		<![CDATA[ AND A.ENT_YMD <= #{SRCH_TERM_END_VALUE} ]]>
		</if>  	
	</if>
</if>

<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_EMP_VALUE)'>
	AND (
		   A.EMP_NM LIKE '%'||#{SRCH_EMP_VALUE}||'%'
		OR A.EMP_CD LIKE '%'||UPPER(#{SRCH_EMP_VALUE})||'%'
		OR A.USER_ID LIKE '%'||#{SRCH_EMP_VALUE}||'%'
		OR A.PERNO = #{SRCH_EMP_VALUE} /* 개인정보보호를 위해 정확히 기입했을때만 조회 */
		OR A.HPNO LIKE '%'||#{SRCH_EMP_VALUE}||'%'
	)
</if>
 ORDER BY A.EMP_NM
</select>

<!-- 월별 인사 마감 목록 조회 (마감월 없음) -->
<select id="selectEmpMonthAllList" parameterType="InSaVO"  resultType="Hmap" >  
/* insa-mapper.xml selectEmpMonthAllList 월별 인사 마감 목록 조회 (마감월 없음) */
SELECT A.* FROM (
<foreach collection="COM_YM_ARR"  item="item" separator=" UNION ALL "><![CDATA[
SELECT A.* FROM ( 
SELECT A.*
     , UP_EMP.EMP_NM AS UP_EMP_NM
     ${queryStr}
  FROM (SELECT A.COM_YM
  			 , A.MB_ID             /* 회원사ID                                     VARCHAR2(20)   */
		     , A.SEQ               /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
		     , A.EMP_CD            /* 사원코드                                     VARCHAR2(20)   */
		     , A.EMP_NM            /* 사원명                                       VARCHAR2(20)   */
		     , A.USER_ID           /* 사원ID                                       VARCHAR2(20)   */
		     , A.SCD               /* 조직코드                                     VARCHAR2(20)   */
			 , B.SNM 	           /* 조직이름 */
		     , A.PERNO             /* 주민등록번호                                 VARCHAR2(4000) */
		     , A.HPNO              /* 핸드폰번호                                   VARCHAR2(20)   */
		     , A.JOIN_GBN          /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
		     , A.TELNO             /* 집 전화번호                                  VARCHAR2(15)   */
		     , A.JIKGUB            /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
		     , A.JIKCHK            /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
		     , A.ROLE_ID           /* 시스템 사용권한                              VARCHAR2(10)   */
		     , (SELECT ROLE_NAME FROM TBSY_ROLES_MST WHERE MB_ID = #{MB_ID} AND ROLE_ID = A.ROLE_ID) AS ROLE_NM /* 시스템 사용권한명 */
		     , A.EMAIL             /* 이메일                                       VARCHAR2(50)   */
		     , A.ZIPCD             /* 우편번호                                     VARCHAR2(7)    */
		     , A.ADDR1             /* 자택주소                                     VARCHAR2(200)  */
		     , A.ADDR2             /* 자택주소상세                                 VARCHAR2(200)  */
		     , A.EMPSTA            /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
		     , A.PAY_GBN           /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
		     , A.RE_EMP_CD         /* 소개자 사원코드                              VARCHAR2(20)   */
		     , A.RE_EMP_NM         /* 소개자 사원명                                VARCHAR2(20)   */
		     , (SELECT SNM FROM TBIN_SCD WHERE SCD = (SELECT SCD FROM TBIN_EMPMST WHERE EMP_CD = RE_EMP_NM AND MB_ID = #{MB_ID}) AND MB_ID = #{MB_ID}) AS RE_EMP_SNM /* 소개자 조직명 */
		     , A.RCRT_TYPE         /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
		     , (SELECT CD_VL_NM FROM TBCM_COMMON_CODE WHERE GRP_CMM_CD = 'RCRT_TYPE' AND MB_ID = #{MB_ID} AND CD_VL = A.RCRT_TYPE) AS RCRT_TYPENM /* 유치방식명 */
		     , A.ENT_YMD           /* 입사일자                                     VARCHAR2(10)   */
		     , A.END_YMD           /* 퇴사일자                                     VARCHAR2(10)   */
		     , A.BANK              /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
		     , A.BK_ID             /* 계좌번호                                     VARCHAR2(66)   */
		     , A.OWNER             /* 예금주                                       VARCHAR2(50)   */
		     , A.OWNER_RELATION    /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
		     , (SELECT CD_VL_NM FROM TBCM_COMMON_CODE WHERE GRP_CMM_CD = 'OWNER_RELATION' AND MB_ID = #{MB_ID} AND CD_VL = A.OWNER_RELATION) AS OWNER_RELATIONNM  /* 예금주와의 관계명 */
		     , A.MEMO              /* 메모                                         VARCHAR2(1000) */
		     , A.FILE_NAME         /* 첨부파일명                                   VARCHAR2(200)  */
		     , A.IN_EMP_CD         /* 입력자 사번                                  VARCHAR2(20)   */
		     , TO_CHAR(A.IN_DTM, 'YYYY-MM-DD HH24:MI:SS') AS IN_DTM /* 입력 일시   DATE(7)        */
		     , A.IN_IP             /* 입력자 IP                                    VARCHAR2(40)   */
		     , A.UP_EMP_CD         /* 수정자 사번                                  VARCHAR2(20)   */
		     , TO_CHAR(A.UP_DTM, 'YYYY-MM-DD HH24:MI:SS') AS UP_DTM /* 수정일시    DATE(7)        */
		     , CRE_EMP_CD
		     , CRE_DTM
		     , MDF_EMP_CD
		     , MDF_DTM
	         , B.SCDNMPATH       /* 소속경로 */
	         , B.SCDPATH         /* 소속코드경로 */
	         , B.SNMPATH         /* 소속경로2 */
          FROM TBIN_EMP_MONTH A /* 인사_마스터(상세정보)      */
     		   LEFT OUTER JOIN 
     		   (SELECT COM_YM
     		         , SUBSTR(SYS_CONNECT_BY_PATH(SCD,'>'), 2) AS SCDPATH
	                 , SUBSTR(SYS_CONNECT_BY_PATH(SNM,'>'), 2) AS SCDNMPATH
					 , CASE WHEN SCD = '0000' THEN SNM
				            ELSE SUBSTR(SYS_CONNECT_BY_PATH(SNM,'/'), (SELECT LENGTH(SNM) FROM TBIN_SCD WHERE MB_ID = 'GNX' AND SCD = '0000')+3)
				       END AS SNMPATH    /* 소속경로2 */
	                 , SCD
	                 , SNM
	                 , MB_ID
]]>	                 
	              FROM (SELECT * FROM TBIN_SCD_MONTH WHERE MB_ID = #{MB_ID} AND COM_YM = '${item.VALUE}' ) A
	             START WITH PSCD IS NULL
	           CONNECT BY PRIOR SCD = PSCD
	           ) B
	           ON  A.MB_ID  = B.MB_ID
	           AND A.COM_YM = B.COM_YM
	           AND A.SCD    = B.SCD
	   ) A
	   LEFT OUTER JOIN TBIN_EMPMST UP_EMP
	   ON  A.MB_ID     = UP_EMP.MB_ID
	   AND A.UP_EMP_CD = UP_EMP.EMP_CD 	   
 WHERE A.MB_ID  = #{MB_ID}
   AND A.COM_YM = '${item.VALUE}'
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(EMP_CD)'>
   AND A.EMP_CD = #{EMP_CD}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_SCD)'>    
	AND A.SCDPATH LIKE '%' || #{SRCH_SCD} || '%'
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_JIKCHK)'>    
	AND A.JIKCHK = #{SRCH_JIKCHK}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_JIKGUB)'>    
	AND A.JIKGUB = #{SRCH_JIKGUB}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_ROLE_ID)'>    
	AND A.ROLE_ID = #{SRCH_ROLE_ID}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_EMPSTA)'>    
	AND A.EMPSTA = #{SRCH_EMPSTA}
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_START_VALUE)'>
	<if test='@kr.co.fw.common.util.CommUtil@isEquals(SRCH_TERM, "01")'>    <!-- 입사일 -->
		<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_END_VALUE)'>
		AND A.ENT_YMD BETWEEN #{SRCH_TERM_START_VALUE} AND #{SRCH_TERM_END_VALUE}
		</if>  
		<if test='@kr.co.fw.common.util.CommUtil@isEmpty(SRCH_TERM_END_VALUE)'>
		<![CDATA[ AND A.ENT_YMD >= #{SRCH_TERM_START_VALUE} ]]>
		</if>		
	</if>
</if>
<if test='@kr.co.fw.common.util.CommUtil@isEmpty(SRCH_TERM_START_VALUE)'>
	<if test='@kr.co.fw.common.util.CommUtil@isEquals(SRCH_TERM, "01")'>    <!-- 입사일 -->
		<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_TERM_END_VALUE)'>
		<![CDATA[ AND A.ENT_YMD <= #{SRCH_TERM_END_VALUE} ]]>
		</if>  	
	</if>
</if>

<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_EMP_VALUE)'>
	AND (
		   A.EMP_NM LIKE '%'||#{SRCH_EMP_VALUE}||'%'
		OR A.EMP_CD LIKE '%'||UPPER(#{SRCH_EMP_VALUE})||'%'
		OR A.USER_ID LIKE '%'||#{SRCH_EMP_VALUE}||'%'
		OR A.PERNO = #{SRCH_EMP_VALUE} /* 개인정보보호를 위해 정확히 기입했을때만 조회 */
		OR A.HPNO LIKE '%'||#{SRCH_EMP_VALUE}||'%'
	)
</if>
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(SRCH_EMP_DETAIL)'>
	AND A.COM_YM >= TO_CHAR(ADD_MONTHS(SYSDATE, -6), 'YYYYMM')	/* 인사 상세정보 : 6개월 전까지 보여지도록 */
</if>
 ORDER BY A.EMP_NM
 ) A  
</foreach>
) A
</select>

<!-- 월별 인사마감 중 하나의 사원정보 조회 -->
<select id="selectEmpMonth" parameterType="InSaVO" resultType="Hmap" >
/* insa-mapper.xml selectEmpMonth 월별 인사마감 중 하나의 사원정보 조회 */
SELECT MB_ID             /* 회원사ID                                     VARCHAR2(20)   */
     , SEQ               /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
     , EMP_CD            /* 사원코드                                     VARCHAR2(20)   */
     , EMP_NM            /* 사원명                                       VARCHAR2(20)   */
     , USER_ID           /* 사원ID                                       VARCHAR2(20)   */
     , SCD               /* 조직코드                                     VARCHAR2(20)   */
     , PERNO             /* 주민등록번호                                 VARCHAR2(4000) */
     , HPNO              /* 핸드폰번호                                   VARCHAR2(20)   */
     , JOIN_GBN          /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
     , TELNO             /* 집 전화번호                                  VARCHAR2(15)   */
     , JIKGUB            /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
     , JIKCHK            /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
     , ROLE_ID           /* 시스템 사용권한                              VARCHAR2(10)   */
     , EMAIL             /* 이메일                                       VARCHAR2(50)   */
     , ZIPCD             /* 우편번호                                     VARCHAR2(7)    */
     , ADDR1             /* 자택주소                                     VARCHAR2(200)  */
     , ADDR2             /* 자택주소상세                                 VARCHAR2(200)  */
     , EMPSTA            /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
     , PAY_GBN           /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
     , RE_EMP_CD         /* 소개자 사원코드                              VARCHAR2(20)   */
     , RE_EMP_NM         /* 소개자 사원명                                VARCHAR2(20)   */
     , RCRT_TYPE         /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
     , ENT_YMD           /* 입사일자                                     VARCHAR2(10)   */
     , END_YMD           /* 퇴사일자                                     VARCHAR2(10)   */
     , BANK              /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
     , BK_ID             /* 계좌번호                                     VARCHAR2(66)   */
     , OWNER             /* 예금주                                       VARCHAR2(50)   */
     , OWNER_RELATION    /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , MEMO              /* 메모                                         VARCHAR2(1000) */
     , FILE_NAME         /* 첨부파일명                                   VARCHAR2(200)  */
     , IN_EMP_CD         /* 입력자 사번                                  VARCHAR2(20)   */
     , TO_CHAR(IN_DTM, 'YYYY-MM-DD') AS IN_DTM            /* 입력 일시                                    DATE(7)        */
     , IN_IP             /* 입력자 IP                                    VARCHAR2(40)   */
     , UP_EMP_CD         /* 수정자 사번                                  VARCHAR2(20)   */
     , TO_CHAR(UP_DTM, 'YYYY-MM-DD') AS UP_DTM            /* 수정일시                                     DATE(7)        */
  FROM TBIN_EMP_MONTH
 WHERE COM_YM = #{COM_YM}
   AND MB_ID  = #{MB_ID}
   AND EMP_CD = #{EMP_CD}
</select>

<!-- 월별 인사 마감 입력 -->
<insert id="insertEmpMonth" parameterType="InSaVO">
/* insa-mapper.xml insertEmpMonth 월별 인사 마감 입력 */
INSERT
  INTO TBIN_EMP_MONTH /* [IN][인사] 월별 인사마감 */
     ( COM_YM
     , MB_ID             /* 회원사ID                                     VARCHAR2(20)   */
     , SEQ               /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
     , EMP_CD            /* 사원코드                                     VARCHAR2(20)   */
     , EMP_NM            /* 사원명                                       VARCHAR2(20)   */
     , USER_ID           /* 사원ID                                       VARCHAR2(20)   */
     , SCD               /* 조직코드                                     VARCHAR2(20)   */
     , PERNO             /* 주민등록번호                                 VARCHAR2(4000) */
     , HPNO              /* 핸드폰번호                                   VARCHAR2(20)   */
     , JOIN_GBN          /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
     , TELNO             /* 집 전화번호                                  VARCHAR2(15)   */
     , JIKGUB            /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
     , JIKCHK            /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
     , ROLE_ID           /* 시스템 사용권한                              VARCHAR2(10)   */
     , EMAIL             /* 이메일                                       VARCHAR2(50)   */
     , ZIPCD             /* 우편번호                                     VARCHAR2(7)    */
     , ADDR1             /* 자택주소                                     VARCHAR2(200)  */
     , ADDR2             /* 자택주소상세                                 VARCHAR2(200)  */
     , EMPSTA            /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
     , PAY_GBN           /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
     , RE_EMP_CD         /* 소개자 사원코드                              VARCHAR2(20)   */
     , RE_EMP_NM         /* 소개자 사원명                                VARCHAR2(20)   */
     , RCRT_TYPE         /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
     , ENT_YMD           /* 입사일자                                     VARCHAR2(10)   */
     , END_YMD           /* 퇴사일자                                     VARCHAR2(10)   */
     , BANK              /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
     , BK_ID             /* 계좌번호                                     VARCHAR2(66)   */
     , OWNER             /* 예금주                                       VARCHAR2(50)   */
     , OWNER_RELATION    /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , MEMO              /* 메모                                         VARCHAR2(1000) */
     , FILE_NAME         /* 첨부파일명                                   VARCHAR2(200)  */
     , IN_EMP_CD         /* 입력자 사번                                  VARCHAR2(20)   */
     , IN_DTM            /* 입력 일시                                    DATE(7)        */
     , IN_IP             /* 입력자 IP                                    VARCHAR2(40)   */
     )
VALUES
     ( #{COM_YM}
     , #{MB_ID         }   /* 회원사ID                                     VARCHAR2(20)   */
     , TBIN_EMPMST_FSB_SEQ.NEXTVAL   /* 일련번호(TBIN_EMPMST_FSB_SEQ)                NUMBER(22)     */
     , #{EMP_CD        }   /* 사원코드                                     VARCHAR2(20)   */
     , #{EMP_NM        }   /* 사원명                                       VARCHAR2(20)   */
     , #{EMP_CD        }   /* 사원ID                                       VARCHAR2(20)   */
     , #{SCD           }   /* 조직코드                                     VARCHAR2(20)   */
     , #{PERNO         }   /* 주민등록번호                                 VARCHAR2(4000) */
     , #{HPNO          }   /* 핸드폰번호                                   VARCHAR2(20)   */
     , #{JOIN_GBN      }   /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
     , #{TELNO         }   /* 집 전화번호                                  VARCHAR2(15)   */
     , #{JIKGUB        }   /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
     , #{JIKCHK        }   /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
     , #{ROLE_ID       }   /* 시스템 사용권한                              VARCHAR2(10)   */
     , #{EMAIL         }   /* 이메일                                       VARCHAR2(50)   */
     , #{ZIPCD         }   /* 우편번호                                     VARCHAR2(7)    */
     , #{ADDR1         }   /* 자택주소                                     VARCHAR2(200)  */
     , #{ADDR2         }   /* 자택주소상세                                 VARCHAR2(200)  */
     , #{EMPSTA        }   /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
     , #{PAY_GBN       }   /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
     , #{RE_EMP_CD     }   /* 소개자 사원코드                              VARCHAR2(20)   */
     , #{RE_EMP_NM     }   /* 소개자 사원명                                VARCHAR2(20)   */
     , #{RCRT_TYPE     }   /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
     , #{ENT_YMD       }   /* 입사일자                                     VARCHAR2(10)   */
     , #{END_YMD       }   /* 퇴사일자                                     VARCHAR2(10)   */
     , #{BANK          }   /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
     , #{BK_ID         }   /* 계좌번호                                     VARCHAR2(66)   */
     , #{OWNER         }   /* 예금주                                       VARCHAR2(50)   */
     , #{OWNER_RELATION}   /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , #{MEMO          }   /* 메모                                         VARCHAR2(1000) */
     , #{FILE_NAME     }   /* 첨부파일명                                   VARCHAR2(200)  */
     , #{IN_EMP_CD     }   /* 입력자 사번                                  VARCHAR2(20)   */
     , SYSDATE             /* 입력 일시                                    DATE(7)        */
     , #{IN_IP         }   /* 입력자 IP                                    VARCHAR2(40)   */
     )
</insert>

<!-- 월별 인사 마감 수정 -->
<update id="updateEmpMonth" parameterType="InSaVO">
/* insa-mapper.xml updateEmpMonth 월별 인사 마감 수정 */
UPDATE TBIN_EMP_MONTH /* [IN][인사] 월별 인사 마감 */
   SET EMP_NM         = #{EMP_NM        }    /* 사원명                                       VARCHAR2(20)   */
     , SCD            = #{SCD           }    /* 조직코드                                     VARCHAR2(20)   */
     , PERNO          = #{PERNO         }    /* 주민등록번호                                 VARCHAR2(4000) */
     , HPNO           = #{HPNO          }    /* 핸드폰번호                                   VARCHAR2(20)   */
     , JOIN_GBN       = #{JOIN_GBN      }    /* 입사구분(GRP_CMM_CD = JOIN_GBN)              VARCHAR2(20)   */
     , TELNO          = #{TELNO         }    /* 집 전화번호                                  VARCHAR2(15)   */
     , JIKGUB         = #{JIKGUB        }    /* 직급코드(GRP_CMM_CD = JIKGUB)                VARCHAR2(20)   */
     , JIKCHK         = #{JIKCHK        }    /* 직책코드(GRP_CMM_CD = JIKCHK)                VARCHAR2(20)   */
     , ROLE_ID        = #{ROLE_ID       }    /* 시스템 사용권한                              VARCHAR2(10)   */
     , EMAIL          = #{EMAIL         }    /* 이메일                                       VARCHAR2(50)   */
     , ZIPCD          = #{ZIPCD         }    /* 우편번호                                     VARCHAR2(7)    */
     , ADDR1          = #{ADDR1         }    /* 자택주소                                     VARCHAR2(200)  */
     , ADDR2          = #{ADDR2         }    /* 자택주소상세                                 VARCHAR2(200)  */
     , EMPSTA         = #{EMPSTA        }    /* 재직여부(GRP_CMM_CD = EMPSTA)                VARCHAR2(20)   */
     , PAY_GBN        = #{PAY_GBN       }    /* 급여구분(GRP_CMM_CD = PAY_GBN)               VARCHAR2(20)   */
     , RE_EMP_CD      = #{RE_EMP_CD     }    /* 소개자 사원코드                              VARCHAR2(20)   */
     , RE_EMP_NM      = #{RE_EMP_NM     }    /* 소개자 사원명                                VARCHAR2(20)   */
     , RCRT_TYPE      = #{RCRT_TYPE     }    /* 유치방식(GRP_CMM_CD = RCRT_TYPE)             VARCHAR2(1)    */
     , END_YMD        = #{END_YMD       }    /* 퇴사일자                                     VARCHAR2(10)   */
     , BANK           = #{BANK          }    /* 은행코드(GRP_CMM_CD = BANK)                  VARCHAR2(20)   */
     , BK_ID          = #{BK_ID         }    /* 계좌번호                                     VARCHAR2(66)   */
     , OWNER          = #{OWNER         }    /* 예금주                                       VARCHAR2(50)   */
     , OWNER_RELATION = #{OWNER_RELATION}    /* 예금주와의 관계(GRP_CMM_CD = OWNER_RELATION) VARCHAR2(20)   */
     , MEMO           = #{MEMO          }    /* 메모                                         VARCHAR2(1000) */
     , FILE_NAME      = #{FILE_NAME     }    /* 첨부파일명                                   VARCHAR2(200)  */
     , UP_EMP_CD      = #{UP_EMP_CD     }    /* 수정자 사번                                  VARCHAR2(20)   */
     , UP_DTM         = SYSDATE              /* 수정일시                                     DATE(7)        */
 WHERE COM_YM = #{COM_YM}
   AND MB_ID  = #{MB_ID}
   AND EMP_CD = #{EMP_CD}
</update>

<!-- 월별 인사 마감 삭제 -->
<delete id="deleteEmpMonth" parameterType="InSaVO">
/* insa-mapper.xml deleteEmpMonth 월별 인사 마감 삭제 */
DELETE TBIN_EMP_MONTH /* [IN][인사] 월별 인사 마감 */
 WHERE COM_YM = #{COM_YM}
   AND MB_ID  = #{MB_ID}
   AND EMP_CD = #{EMP_CD}
</delete>

<!-- 계정찾기 재직자 조회 -->
<select id="selectEmpCount" parameterType="InSaVO" resultType="Integer" >
/* insa-mapper.xml selectEmpCount 계정찾기 재직자 조회 */
SELECT COUNT(EMP_CD) AS total
  FROM TBIN_EMPMST
 WHERE EMP_NM = #{EMP_NM}
   AND REPLACE(HPNO, '-', '') = #{HPNO}
   AND MB_ID = UPPER(REPLACE(#{MB_ID},'_',''))
   AND EMPSTA = '재직'
<if test='@kr.co.fw.common.util.CommUtil@isNotEmpty(EMP_CD)'>
   AND EMP_CD = #{EMP_CD} 
</if>
</select>

<!-- 계정찾기 재직자 아이디조회 -->
<select id="getUserAuthId" parameterType="InSaVO" resultType="String" >
/* insa-mapper.xml getUserAuthId  계정찾기 재직자 아이디조회 */
SELECT EMP_CD
  FROM TBIN_EMPMST
 WHERE EMP_NM = REPLACE(#{EMP_NM}, ' ', '')
   AND REPLACE(HPNO, '-', '') = #{HPNO}
   AND MB_ID = UPPER(REPLACE(#{MB_ID},'_',''))
   AND EMPSTA = '재직'
</select>

</mapper>
